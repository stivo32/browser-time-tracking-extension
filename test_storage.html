<!DOCTYPE html>
<html>
<head>
    <title>Test Storage</title>
</head>
<body>
    <h1>Chrome Extension Storage Test</h1>
    <button id="check-storage">Check Storage</button>
    <button id="add-test-data">Add Test Data</button>
    <div id="output"></div>
    
    <script>
        document.getElementById('check-storage').addEventListener('click', async () => {
            try {
                const today = new Date().toISOString().split('T')[0];
                const sessionKey = `session_${today}`;
                
                const result = await chrome.storage.local.get([sessionKey]);
                console.log('Storage result:', result);
                
                document.getElementById('output').innerHTML = `
                    <h3>Storage Check Results:</h3>
                    <p><strong>Date:</strong> ${today}</p>
                    <p><strong>Session Key:</strong> ${sessionKey}</p>
                    <p><strong>Data:</strong></p>
                    <pre>${JSON.stringify(result, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('output').innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        });
        
        document.getElementById('add-test-data').addEventListener('click', async () => {
            try {
                const today = new Date().toISOString().split('T')[0];
                const sessionKey = `session_${today}`;
                
                const testData = {
                    domains: {
                        'example.com': {
                            totalTime: 300, // 5 minutes
                            pages: {
                                'https://example.com/page1': 150,
                                'https://example.com/page2': 150
                            }
                        },
                        'test.com': {
                            totalTime: 120, // 2 minutes
                            pages: {
                                'https://test.com/': 120
                            }
                        }
                    }
                };
                
                await chrome.storage.local.set({ [sessionKey]: testData });
                
                document.getElementById('output').innerHTML = `
                    <h3>Test Data Added:</h3>
                    <p>Added test data for ${today}</p>
                    <pre>${JSON.stringify(testData, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('output').innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        });
    </script>
</body>
</html>
